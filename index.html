<!DOCTYPE html>
<html lang="en">

  <head>

  <meta charset="UTF-8">

  <meta name="description" content="Python FastAPI with a collection of Minecraft Skin rendering APIs.">
  <meta property="og:title" content="Skindentity">
  <meta property="og:description" content="Python FastAPI with a collection of Minecraft Skin rendering APIs.">
  <meta property="og:image" content="https://raw.github.com/Sorrowfall/Skindentity/main/icon.png">

  <title>Skindentity</title>
  <link rel="icon" href="https://raw.github.com/Sorrowfall/Skindentity/main/icon.png">

  <style>
#container {
margin: auto;
width: 73%;
background-color: gray;
padding: 2%
}

.render img {
-ms-interpolation-mode: nearest-neighbor;
image-rendering: crisp-edges;
image-rendering: pixelated;
width: 320px;
padding-top: 1%;
padding-bottom: 1%;
}
  </style>

  <script>
function main() {
  const renders = ['portrait', 'profile', 'skin'];
  const options = ['player_name', 'skin_url', 'skin_file'];
  for (i in renders) {
    const render = renders[i]
    var div = document.createElement('div');
    div.id = render;
    div.classList.add('render');
    var text_div = document.createElement('div');
    text_div.classList.add('text');
    var label = document.createElement('label');
    label.innerText = 'https://skindentity.deta.dev/'+render+'/?';
    var select = document.createElement('select');
    select.onchange = function() {switchInput(this)};
    for (e in options) {
        const opt = options[e];
        var option = document.createElement('option');
        option.value = opt;
        option.innerHTML = opt;
        select.appendChild(option);
    };
    var label_two = document.createElement('label');
    label_two.innerText = '=';
    var input = document.createElement('input');
    input.onchange = function() {updateImage(this)};
    //input.onblur = function() {updateImage(this)};
    input.type = 'minecraft_player';
    input.placeholder = 'Steve';
    var img = document.createElement('img');
    img.src = 'https://raw.github.com/Sorrowfall/Skindentity/main/previews/' + render + '.png';
    img.onerror = async function() {this.src = 'https://raw.github.com/Sorrowfall/Skindentity/main/previews/' + render + '.png'};

    text_div.appendChild(label);
    text_div.appendChild(select);
    text_div.appendChild(label_two);
    text_div.appendChild(input);
    div.appendChild(text_div);
    div.appendChild(img);

    document.getElementById('container').appendChild(div);
  }
}

function updateImage(element) {
  const div = element.parentElement;
  const input = element.value;
  const label = div.getElementsByTagName('label')[0];
  const select = div.getElementsByTagName('select')[0];
  const option = select.value;
  var img = div.parentElement.getElementsByTagName('img')[0];
  var url = label.innerText + select.value + '=';
  switch(option) {
    case 'player_name':
      img.src = url + input;
      break;
    case 'skin_url':
      img.src = url + input;
      break;
    case 'skin_file':
      const file = element.files[0];
      var reader = new FileReader();

      reader.onloadend = function() {
        var b64 = reader.result.replace(/^data:.+;base64,/, '');
        img.src = label.innerText + 'skin_base64=' + b64 + '=';
      };
      
      reader.readAsDataURL(file);
      break;
  }
}

function switchInput(element) {
  const div = element.parentElement;
  const option = element.value;
  var input = div.getElementsByTagName('input')[0];
  switch(option) {
    case 'player_name':
      input.type = 'minecraft_player';
      input.placeholder = 'Steve';
    break;
    case 'skin_url':
      input.type = 'minecraft_skin_url';
      input.placeholder = 'http://assets.mojang.com/SkinTemplates/steve.png';
    break;
    case 'skin_file':
      input.type = 'file';
      input.placeholder = null;
    break;
  }
}

  </script>

  </head>

  <body onload="main()">
  <div id='container'>
  </body>

</html>